---
- name: playbook completo
  hosts: all
  tasks:
    - name: SCP
      shell: scp -p node1.example.com:{{rutaNuevoJar}} {{rutaGuardarJar}}
      delegate_to: node2.example.com

    - name: Bajar el servicio
      command: pkill -9 -f {{nombreJar}}.jar
    
    - name: Cambiar nombre antiguo jar
      command: mv {{nombreJar}} {{antiguoJar}}
    
    - name: Mover el nuevo jar a la carpetaJar
      command: mv {{rutaGuardarJar}} {{carpetaJar}}

    - name: Levantar el nuevo proceso
      shell: nohup java -jar {{rutaProceso}} &> {{rutaOut}} 2>&1&
      delegate_to: node2.example.com
    
